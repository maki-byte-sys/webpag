<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Enrollment System - Student Management</title>

<!-- Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Font Awesome -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

<!-- Google Font -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<style>
* { font-family: 'Poppins', sans-serif; }

body {
    background: linear-gradient(135deg, #eef2f7, #f8f9fb);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}

/* ===== HEADER ===== */
.header-section {
    position: relative;
    padding: 80px 20px;
    background: linear-gradient(135deg, #0d6efd, #6610f2);
    color: #fff;
    overflow: hidden;
}

.header-section::before,
.header-section::after {
    content: "";
    position: absolute;
    width: 300px;
    height: 300px;
    background: rgba(255,255,255,0.15);
    border-radius: 50%;
    filter: blur(80px);
    animation: float 10s infinite alternate;
}

.header-section::before { top: -100px; left: -100px; }
.header-section::after { bottom: -120px; right: -120px; animation-delay: 2s; }

@keyframes float {
    from { transform: translateY(0); }
    to { transform: translateY(40px); }
}

.header-card {
    max-width: 700px;
    margin: auto;
    background: rgba(255,255,255,0.15);
    border-radius: 25px;
    padding: 35px;
    backdrop-filter: blur(12px);
    box-shadow: 0 25px 60px rgba(0,0,0,0.3);
}

.school-icon {
    width: 80px;
    height: 80px;
    background: rgba(255,255,255,0.2);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 36px;
    margin: auto auto 15px;
}

.system-title { font-weight: 700; }

/* ===== NAV ===== */
.nav-section {
    box-shadow: 0 6px 20px rgba(0,0,0,0.05);
}

.nav-tabs .nav-link.active {
    background: linear-gradient(135deg, #0d6efd, #6610f2);
    color: #fff;
    border-radius: 8px;
}

/* ===== CARD ===== */
.card {
    border-radius: 20px;
    box-shadow: 0 15px 40px rgba(0,0,0,0.08);
}

/* ===== TABLE ===== */
.student-table tbody tr {
    transition: all 0.3s ease;
}

.student-table tbody tr:hover {
    background: #f8faff;
    transform: scale(1.01);
}

.badge {
    padding: 7px 12px;
    border-radius: 50px;
}

/* ===== FOOTER ===== */
footer {
    margin-top: auto;
    background: #fff;
    border-top: 1px solid #e5e5e5;
    padding: 20px 0;
    color: #666;
}
</style>
</head>
<body>

<!-- HEADER -->
<div class="container-fluid header-section text-center">
    <div class="header-card">
        <div class="school-icon">
            <i class="fas fa-university"></i>
        </div>
        <h1 class="system-title">Enrollment System</h1>
        <p>Binalatongan Community College</p>
    </div>
</div>

<!-- NAV -->
<div class="container-fluid nav-section bg-light py-2">
    <div class="d-flex justify-content-between align-items-center">
        <ul class="nav nav-tabs">

            <li class="nav-item">
                <a class="nav-link active" href="index.html">
                    <i class="fas fa-user-graduate"></i> Student
                </a>
            </li>

            <li class="nav-item">
                <a class="nav-link" href="teachers.html">
                    <i class="fas fa-chalkboard-teacher"></i> Teacher
                </a>
            </li>

            <li class="nav-item">
                <a class="nav-link" href="subjects.html">
                    <i class="fas fa-book"></i> Subject
                </a>
            </li>

            <!-- ✅ CLASS ACCESS -->
            <li class="nav-item">
                <a class="nav-link" href="class_students.html">
                    <i class="fas fa-door-open"></i> Class Access
                </a>
            </li>

        </ul>

        <a href="#" class="btn btn-outline-danger btn-sm">
            <i class="fas fa-sign-out-alt"></i> Logout
        </a>
    </div>
</div>

<!-- MAIN -->
<div class="container mt-4 mb-5">
<div class="card">

<div class="card-header d-flex justify-content-between align-items-center">
    <h4><i class="fas fa-users"></i> Student Details</h4>
    <a href="add_student.html" class="btn btn-primary">
        <i class="fas fa-user-plus"></i> Add Student
    </a>
</div>

<div class="card-body">

<form id="searchForm" class="row g-2 mb-3">
    <div class="col-md-8">
        <input id="searchInput" class="form-control" placeholder="Search by name, course, email">
    </div>
    <div class="col-md-2">
        <button class="btn btn-outline-secondary w-100">
            <i class="fas fa-search"></i>
        </button>
    </div>
    <div class="col-md-2">
        <button type="button" id="clearSearch"
            class="btn btn-secondary w-100 d-none">
            Clear
        </button>
    </div>
</form>

<div class="table-responsive">
<table class="table table-hover student-table">
<thead>
<tr>
    <th>ID</th>
    <th>Name</th>
    <th>Email</th>
    <th>Phone</th>
    <th>Course</th>
    <th>Year</th>
    <th>Section</th>
    <th>GPA</th>
    <th>Status</th>
    <th>Action</th>
</tr>
</thead>
<tbody id="studentTable"></tbody>
</table>
</div>

<div id="paginationArea" class="mt-3"></div>
</div>
</div>
</div>

<!-- FOOTER -->
<footer class="text-center">
    <p class="mb-1">Enrollment System © 2025</p>
    <p class="small mb-0">IT ELEC 3 – Data Mining</p>
</footer>

<!-- VIEW MODAL -->
<div class="modal fade" id="viewModal">
<div class="modal-dialog modal-lg">
<div class="modal-content">
<div class="modal-header">
    <h5><i class="fas fa-user-graduate"></i> Student Details</h5>
    <button class="btn-close" data-bs-dismiss="modal"></button>
</div>
<div class="modal-body">
    <p><strong>ID:</strong> <span id="m_id"></span></p>
    <p><strong>Name:</strong> <span id="m_name"></span></p>
    <p><strong>Email:</strong> <span id="m_email"></span></p>
    <p><strong>Phone:</strong> <span id="m_phone"></span></p>
    <p><strong>Course:</strong> <span id="m_course"></span></p>
    <p><strong>Year Level:</strong> <span id="m_year"></span></p>
    <p><strong>Section:</strong> <span id="m_section"></span></p>
    <p><strong>GPA:</strong> <span id="m_gpa"></span></p>
    <p><strong>Status:</strong> <span id="m_status"></span></p>
</div>
</div>
</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

<script>
const RECORDS_PER_PAGE = 5;
const params = new URLSearchParams(window.location.search);
let currentPage = parseInt(params.get("page")) || 1;
let searchTerm = (params.get("search") || "").toLowerCase();

const studentTable = document.getElementById("studentTable");
const searchForm = document.getElementById("searchForm");
const searchInput = document.getElementById("searchInput");
const clearSearch = document.getElementById("clearSearch");
const paginationArea = document.getElementById("paginationArea");

let students = JSON.parse(localStorage.getItem("students")) || [];
students = students.map(s => ({ ...s, status: s.status || "Active" }));

function getFilteredStudents() {
    if (!searchTerm) return students;
    return students.filter(s =>
        `${s.firstName} ${s.lastName}`.toLowerCase().includes(searchTerm) ||
        (s.email || "").toLowerCase().includes(searchTerm) ||
        (s.course || "").toLowerCase().includes(searchTerm)
    );
}

function renderTable() {
    studentTable.innerHTML = "";
    const filtered = getFilteredStudents();
    const start = (currentPage - 1) * RECORDS_PER_PAGE;
    const pageData = filtered.slice(start, start + RECORDS_PER_PAGE);

    if (!pageData.length) {
        studentTable.innerHTML =
        `<tr><td colspan="10" class="text-center py-4">
        No student records found</td></tr>`;
        return;
    }

    pageData.forEach((s, i) => {
        studentTable.innerHTML += `
        <tr>
            <td>${start + i + 1}</td>
            <td>${s.firstName} ${s.lastName}</td>
            <td>${s.email || "N/A"}</td>
            <td>${s.phone || "N/A"}</td>
            <td>${s.course || "N/A"}</td>
            <td>${s.yearLevel || "N/A"}</td>
            <td>${s.section || "N/A"}</td>
            <td>${s.gpa || "N/A"}</td>
            <td><span class="badge bg-success">${s.status}</span></td>
            <td>
                <button class="btn btn-info btn-sm me-1"
                    onclick="viewStudent(${s.id})">
                    <i class="fas fa-eye"></i>
                </button>
                <button class="btn btn-warning btn-sm me-1"
                    onclick="editStudent(${s.id})">
                    <i class="fas fa-edit"></i>
                </button>
                <button class="btn btn-danger btn-sm"
                    onclick="deleteStudent(${s.id})">
                    <i class="fas fa-trash"></i>
                </button>
            </td>
        </tr>`;
    });

    renderPagination(filtered.length);
}

function renderPagination(total) {
    paginationArea.innerHTML = "";
    const pages = Math.ceil(total / RECORDS_PER_PAGE);
    for (let i = 1; i <= pages; i++) {
        paginationArea.innerHTML += `
        <a class="btn btn-sm ${i === currentPage ? "btn-primary" : "btn-outline-primary"} me-1"
           href="?page=${i}&search=${searchTerm}">${i}</a>`;
    }
}

function viewStudent(id) {
    const s = students.find(x => x.id === id);
    if (!s) return;
    m_id.textContent = s.id;
    m_name.textContent = `${s.firstName} ${s.lastName}`;
    m_email.textContent = s.email;
    m_phone.textContent = s.phone;
    m_course.textContent = s.course;
    m_year.textContent = s.yearLevel;
    m_section.textContent = s.section;
    m_gpa.textContent = s.gpa;
    m_status.textContent = s.status;
    new bootstrap.Modal(document.getElementById("viewModal")).show();
}

function editStudent(id) {
    localStorage.setItem(
        "editStudent",
        JSON.stringify(students.find(s => s.id === id))
    );
    location.href = "edit_student.html";
}

function deleteStudent(id) {
    if (!confirm("Delete this student?")) return;
    students = students.filter(s => s.id !== id);
    localStorage.setItem("students", JSON.stringify(students));
    renderTable();
}

searchInput.value = searchTerm;
clearSearch.classList.toggle("d-none", !searchTerm);

searchForm.addEventListener("submit", e => {
    e.preventDefault();
    location.href = `?search=${searchInput.value}&page=1`;
});

clearSearch.onclick = () => location.href = "index.html";

renderTable();
</script>

</body>
</html>
