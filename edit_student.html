<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Edit Student - Enrollment System</title>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
.header-section {
    background: #0d6efd;
    color: white;
    padding: 20px;
}
</style>
</head>
<body>

<!-- Header -->
<div class="container-fluid header-section text-center">
    <h1>Enrollment System</h1>
    <p>Binalatongan Community College</p>
</div>

<!-- Navigation -->
<div class="container-fluid bg-light py-2">
<ul class="nav nav-tabs">
    <li class="nav-item"><a class="nav-link active" href="index.html">Student</a></li>
    <li class="nav-item"><a class="nav-link" href="teachers.html">Teacher</a></li>
    <li class="nav-item"><a class="nav-link" href="subjects.html">Subject</a></li>
</ul>
</div>

<div class="container mt-4">

<a href="index.html" class="btn btn-secondary mb-3">
    <i class="fas fa-arrow-left"></i> Back
</a>

<div class="card">
<div class="card-header">
    <h3><i class="fas fa-user-edit"></i> Edit Student</h3>
</div>

<div class="card-body">
<form id="studentForm">
<div class="row">

<!-- Name -->
<div class="col-md-4 mb-3">
<label>First Name *</label>
<input type="text" id="firstName" class="form-control" required>
</div>

<div class="col-md-4 mb-3">
<label>Middle Name</label>
<input type="text" id="middleName" class="form-control">
</div>

<div class="col-md-4 mb-3">
<label>Last Name *</label>
<input type="text" id="lastName" class="form-control" required>
</div>

<!-- Contact -->
<div class="col-md-6 mb-3">
<label>Email *</label>
<input type="email" id="email" class="form-control" required>
</div>

<div class="col-md-6 mb-3">
<label>Phone *</label>
<input type="text" id="phone" class="form-control" required>
</div>

<!-- Academic -->
<div class="col-md-6 mb-3">
<label>Course *</label>
<select id="course" class="form-select" required>
    <option>BSIT</option>
    <option>BED</option>
    <option>BSBA</option>
    <option>BSHM</option>
</select>
</div>

<div class="col-md-6 mb-3">
<label>Year Level *</label>
<select id="yearLevel" class="form-select" required>
    <option>1st Year</option>
    <option>2nd Year</option>
    <option>3rd Year</option>
    <option>4th Year</option>
</select>
</div>

<div class="col-md-4 mb-3">
<label>Section *</label>
<input type="text" id="section" class="form-control" required>
</div>

<div class="col-md-4 mb-3">
<label>GPA *</label>
<input type="number" id="gpa" class="form-control" step="0.01" min="1" max="5" required>
</div>

<div class="col-md-4 mb-3">
<label>Status *</label>
<select id="status" class="form-select" required>
    <option>Active</option>
    <option>Inactive</option>
    <option>Irregular</option>
</select>
</div>

</div>

<button class="btn btn-primary btn-lg">
    <i class="fas fa-save"></i> Save Changes
</button>

</form>
</div>
</div>

</div>

<script>
let editStudent, students = [];

try {
    editStudent = JSON.parse(localStorage.getItem("editStudent"));
    students = JSON.parse(localStorage.getItem("students")) || [];
} catch {
    alert("Error loading data.");
    location.href = "index.html";
}

if (!editStudent) {
    alert("No student selected.");
    location.href = "index.html";
}

/* PREFILL */
firstName.value = editStudent.firstName || "";
middleName.value = editStudent.middleName || "";
lastName.value = editStudent.lastName || "";
email.value = editStudent.email || "";
phone.value = editStudent.phone || "";
course.value = editStudent.course || "";
yearLevel.value = editStudent.yearLevel || "";
section.value = editStudent.section || "";
gpa.value = editStudent.gpa || "";
status.value = editStudent.status || "";

/* SAVE */
document.getElementById("studentForm").addEventListener("submit", e => {
    e.preventDefault();

    const index = students.findIndex(s => s.id === editStudent.id);
    if (index === -1) return;

    students[index] = {
        ...students[index],
        firstName: firstName.value.trim(),
        middleName: middleName.value.trim(),
        lastName: lastName.value.trim(),
        email: email.value.trim(),
        phone: phone.value.trim(),
        course: course.value,
        yearLevel: yearLevel.value,
        section: section.value.trim(),
        gpa: gpa.value,
        status: status.value
    };

    localStorage.setItem("students", JSON.stringify(students));
    localStorage.removeItem("editStudent");

    alert("Student updated successfully!");
    location.href = "index.html";
});
</script>

</body>
</html>
