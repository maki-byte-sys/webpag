<!DOCTYPE html>
<html>
<head>
<title>Edit Subject</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<div class="container mt-4">
<h3>Edit Subject</h3>

<form id="subjectForm">
<input class="form-control mb-2" id="code" required>
<input class="form-control mb-2" id="name" required>
<input class="form-control mb-2" id="units" type="number" required>

<select class="form-select mb-2" id="course"></select>
<select class="form-select mb-2" id="yearLevel"></select>
<select class="form-select mb-3" id="status"></select>

<button class="btn btn-primary">Save Changes</button>
<a href="subjects.html" class="btn btn-secondary">Cancel</a>
</form>
</div>

<script>
const editSubject = JSON.parse(localStorage.getItem("editSubject"));
let subjects = JSON.parse(localStorage.getItem("subjects")) || [];

if (!editSubject) location.href = "subjects.html";

code.value = editSubject.code;
name.value = editSubject.name;
units.value = editSubject.units;
course.innerHTML = `<option>${editSubject.course}</option>`;
yearLevel.innerHTML = `<option>${editSubject.yearLevel}</option>`;
status.innerHTML = `<option>${editSubject.status}</option>`;

subjectForm.onsubmit = e => {
    e.preventDefault();

    const i = subjects.findIndex(s => s.id === editSubject.id);
    subjects[i] = { ...editSubject,
        code: code.value,
        name: name.value,
        units: units.value
    };

    localStorage.setItem("subjects", JSON.stringify(subjects));
    localStorage.removeItem("editSubject");
    location.href = "subjects.html";
};
</script>

</body>
</html>
